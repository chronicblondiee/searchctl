kind: IndexTemplate
metadata:
  name: logs-datastream-template
spec:
  index_patterns:
  - "logs-*"
  priority: 200
  data_stream: {}
  template:
    settings:
      number_of_shards: 1
      number_of_replicas: 0
      index:
        refresh_interval: "5s"
        lifecycle:
          name: "logs-policy"
    mappings:
      properties:
        "@timestamp":
          type: date
          format: "strict_date_optional_time||epoch_millis"
        level:
          type: keyword
        message:
          type: text
          analyzer: standard
          fields:
            keyword:
              type: keyword
              ignore_above: 1024
        service:
          properties:
            name:
              type: keyword
            version:
              type: keyword
            environment:
              type: keyword
        host:
          properties:
            name:
              type: keyword
            ip:
              type: ip
        labels:
          type: flattened
        tags:
          type: keyword
        error:
          properties:
            type:
              type: keyword
            message:
              type: text
            stack_trace:
              type: text
              index: false
  composed_of:
  - "logs-mappings"
  - "logs-settings"
  _meta:
    description: "Template for log data streams with structured logging support"
    version: 1